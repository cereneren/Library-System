<!-- Filter bar -->
<div class="filter-bar m-4 " *ngIf="!loading && loans.length">
  <div class="form-check form-check-inline form-check-xl mx-3">
    <input id="fReturned" class="form-check-input" type="checkbox" [(ngModel)]="filters.returned">
    <label class="form-check-label" for="fReturned">{{ 'LOANS.RETURNED' | translate }}</label>
  </div>

  <div class="form-check form-check-inline form-check-xl mx-3">
    <input id="fOnLoan" class="form-check-input" type="checkbox" [(ngModel)]="filters.onLoan">
    <label class="form-check-label" for="fOnLoan">{{ 'LOANS.ON_LOAN' | translate }}</label>
  </div>

  <div class="form-check form-check-inline form-check-xl mx-3">
    <input id="fOverdue" class="form-check-input" type="checkbox" [(ngModel)]="filters.overdue">
    <label class="form-check-label" for="fOverdue">{{ 'LOANS.OVERDUE' | translate }}</label>
  </div>

  <!-- All -->
  <div class="form-check form-check-inline mx-3">
    <input class="form-check-input" type="checkbox"
           [checked]="allChecked"
           [indeterminate]="isCustom"
           (change)="setAllFilters(true)">
    <label class="form-check-label">{{ 'LOANS.ALL' | translate }}</label>
  </div>

  <!-- None -->
  <div class="form-check form-check-inline mx-3">
    <input class="form-check-input" type="checkbox"
           [checked]="noneChecked"
           [indeterminate]="isCustom"
           (change)="setAllFilters(false)">
    <label class="form-check-label">{{ 'LOANS.NONE' | translate }}</label>
  </div>

</div>


<!-- No results messages -->
<div *ngIf="!loading && loans.length === 0" class="text-muted">{{ 'LOANS.NO_LOANS_FOUND' | translate }}</div>
<div *ngIf="!loading && loans.length > 0 && filteredLoans.length === 0" class="text-muted">
  {{ 'LOANS.NO_LOANS_MATCHED' | translate }}
</div>

<!-- Table -->
<div *ngIf="!loading && filteredLoans.length" class="table-responsive mt-4 mb-4 m-4 text-xl">
  <table class="table align-middle">
    <thead>
    <tr>
      <th>{{ 'LOANS.TITLE' | translate }}</th>
      <th>{{ 'LOANS.AUTHOR' | translate }}</th>
      <th *ngIf="isLibrarian">{{ 'LOANS.MEMBER' | translate }}</th>
      <th>{{ 'LOANS.LOANED' | translate }}</th>
      <th>{{ 'LOANS.DUE' | translate }}</th>
      <th>{{ 'LOANS.STATUS' | translate }}</th>
      <th class="text-end" *ngIf="isLibrarian"></th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let l of filteredLoans">
      <td class="fw-semibold">{{ l.book.title }}</td>
      <td>{{ l.book.author || '-' }}</td>
      <td *ngIf="isLibrarian">{{ l.member?.fullName || 'â€”' }}</td>
      <td>{{ l.loanDate | date:'mediumDate' }}</td>
      <td>{{ l.dueDate   | date:'mediumDate' }}</td>
      <td>
          <span *ngIf="l.returnDate" class="badge bg-success">
            {{ 'LOANS.RETURNED' | translate }} {{ l.returnDate | date:'mediumDate' }}
          </span>
        <span *ngIf="!l.returnDate && isOverdue(l)" class="badge bg-danger">{{ 'LOANS.OVERDUE' | translate }}</span>
        <span *ngIf="!l.returnDate && !isOverdue(l)" class="badge bg-warning text-dark">{{ 'LOANS.ON_LOAN' | translate }}</span>
      </td>
      <td class="text-end" *ngIf="isLibrarian">
        <button class="btn btn-outline-primary btn-sm text-xl"
                *ngIf="!l.returnDate"
                (click)="onReturn(l)"
                [disabled]="returning[l.id]">
          {{ returning[l.id] ? ('LOANS.RETURNING' | translate) : ('LOANS.RETURN' | translate) }}
        </button>
      </td>
    </tr>
    </tbody>
  </table>
</div>
